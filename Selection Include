*&---------------------------------------------------------------------*
*& Include          ZRE_CONTRACT_CONV_SEL
*&---------------------------------------------------------------------*


  SELECTION-SCREEN: BEGIN OF BLOCK B2 WITH FRAME TITLE TEXT-001.
*//-- Selection screen
  PARAMETERS P_TEST TYPE TESTRUN DEFAULT 'X'.
  SELECTION-SCREEN: SKIP 1.

  PARAMETERS: P_LOCAL RADIOBUTTON GROUP FILE DEFAULT 'X' USER-COMMAND LOCAL,
              P_UNIX  RADIOBUTTON GROUP FILE.

  SELECTION-SCREEN: SKIP 1.
  SELECTION-SCREEN COMMENT /1(50) TEXT-002 . "'Please upload TAB delimited file only'.
  SELECTION-SCREEN: SKIP 1.
  PARAMETERS: P_FILE01 TYPE FILE_TABLE LOWER CASE OBLIGATORY,
              P_FILE02 TYPE FILE_TABLE LOWER CASE,
              P_FILE03 TYPE FILE_TABLE LOWER CASE,
              P_FILE04 TYPE FILE_TABLE LOWER CASE,
              P_FILE05 TYPE FILE_TABLE LOWER CASE,
              P_FILE06 TYPE FILE_TABLE LOWER CASE,
              P_FILE07 TYPE FILE_TABLE LOWER CASE,
              P_FILE08 TYPE FILE_TABLE LOWER CASE,
              P_FILE09 TYPE FILE_TABLE LOWER CASE,
              P_FILE10 TYPE FILE_TABLE LOWER CASE,
              P_FILE11 TYPE FILE_TABLE LOWER CASE.
  SELECTION-SCREEN: END OF BLOCK B2.


  AT SELECTION-SCREEN OUTPUT.
    LOOP AT SCREEN.
      IF SCREEN-NAME = 'P_UNIX'.
        SCREEN-ACTIVE = '0'. "Field will be disabaled...
        SCREEN-INVISIBLE = '1'. "Field will be invisible...
        MODIFY screen .
      ENDIF.
    ENDLOOP.



*//-- Validations
  AT SELECTION-SCREEN.

    IF SSCRFIELDS-UCOMM = 'LOCAL' AND P_LOCAL EQ 'X'.
      CLEAR:
      P_FILE01,
      P_FILE02,
      P_FILE03,
      P_FILE04,
      P_FILE05,
      P_FILE06,
      P_FILE07,
      P_FILE08,
      P_FILE09,
      P_FILE10,
      P_FILE11.
    ENDIF.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE01.
    PERFORM OPEN_DIALOG USING 'P_FILE01' CHANGING P_FILE01.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE02.
    PERFORM OPEN_DIALOG USING 'P_FILE02' CHANGING P_FILE02.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE03.
    PERFORM OPEN_DIALOG USING 'P_FILE03' CHANGING P_FILE03.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE04.
    PERFORM OPEN_DIALOG USING 'P_FILE04' CHANGING P_FILE04.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE05.
    PERFORM OPEN_DIALOG USING 'P_FILE05' CHANGING P_FILE05.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE06.
    PERFORM OPEN_DIALOG USING 'P_FILE06' CHANGING P_FILE06.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE07.
    PERFORM OPEN_DIALOG USING 'P_FILE07' CHANGING P_FILE07.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE08.
    PERFORM OPEN_DIALOG USING 'P_FILE08' CHANGING P_FILE08.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE09.
    PERFORM OPEN_DIALOG USING 'P_FILE09' CHANGING P_FILE09.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE10.
    PERFORM OPEN_DIALOG USING 'P_FILE10' CHANGING P_FILE10.

  AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE11.
    PERFORM OPEN_DIALOG USING 'P_FILE11' CHANGING P_FILE11.

  FORM OPEN_DIALOG USING FIELDNAME CHANGING P_FILE.
    IF  P_UNIX = 'X'.
      CALL FUNCTION 'F4_DXFILENAME_4_DYNP'
        EXPORTING
          DYNPFIELD_FILENAME = FIELDNAME
          DYNAME             = SY-CPROG "gd_program
          DYNUMB             = SY-DYNNR "gd_dynnr
          FILETYPE           = 'P'
          LOCATION           = 'A'
          SERVER             = ''.
    ELSEIF  P_LOCAL = 'X'.
      DATA: LT_FILETABLE TYPE FILETABLE,
            LV_SUBRC     TYPE SYSUBRC.
      REFRESH : LT_FILETABLE.
      CL_GUI_FRONTEND_SERVICES=>FILE_OPEN_DIALOG(
          EXPORTING WINDOW_TITLE = 'Select Input File'
          CHANGING FILE_TABLE = LT_FILETABLE
                   RC = LV_SUBRC
          EXCEPTIONS FILE_OPEN_DIALOG_FAILED = 1 ).
      IF SY-SUBRC <> 0.
        RAISE EXCEPTION TYPE CX_SY_FILE_OPEN.
      ELSE.
        IF LT_FILETABLE IS NOT INITIAL.
          P_FILE = LT_FILETABLE[ 1 ].
        ENDIF.
      ENDIF.
    ENDIF.
  ENDFORM.

  AT SELECTION-SCREEN ON RADIOBUTTON GROUP FILE.
    IF P_UNIX EQ 'X'.

      DATA: LV_UNIX_BASE_PATH TYPE FILE_TABLE.
      LV_UNIX_BASE_PATH-FILENAME = '\\' && SY-HOST && '\sap\' && SY-SYSID && '\' && SY-MANDT && '\conv\'.
      P_FILE01 = LV_UNIX_BASE_PATH.
      P_FILE02 = LV_UNIX_BASE_PATH.
      P_FILE03 = LV_UNIX_BASE_PATH.
      P_FILE04 = LV_UNIX_BASE_PATH.
      P_FILE05 = LV_UNIX_BASE_PATH.
      P_FILE06 = LV_UNIX_BASE_PATH.
      P_FILE07 = LV_UNIX_BASE_PATH.
      P_FILE08 = LV_UNIX_BASE_PATH.
      P_FILE09 = LV_UNIX_BASE_PATH.
      P_FILE10 = LV_UNIX_BASE_PATH.
      P_FILE11 = LV_UNIX_BASE_PATH.

*    IF sscrfields-ucomm = 'LOCAL'.
*      CLEAR: sscrfields-ucomm.
*    ENDIF.
    ENDIF.


  START-OF-SELECTION.

